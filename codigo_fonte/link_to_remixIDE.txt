https://remix.ethereum.org/#language=solidity&version=soljson-v0.8.28+commit.7893614a.js&code=Ly8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVApwcmFnbWEgc29saWRpdHkgXjAuOC4yODsK
CmNvbnRyYWN0IFRva2VuTWluYXMgewogICAgc3RyaW5nIHB1YmxpYyBuYW1lID0gIlRva2VuIE1p
bmFzIjsKICAgIHN0cmluZyBwdWJsaWMgc3ltYm9sID0gIlRLTSI7CgogICAgdWludDggcHVibGlj
IGRlY2ltYWxzID0gMDsKICAgIHVpbnQyNTYgcHJpdmF0ZSBfdG90YWxTdXBwbHkgPSAxMDA7Cgog
ICAgbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpIHB1YmxpYyBfYmFsYW5jZXM7CiAgICBtYXBw
aW5nKGFkZHJlc3MgPT4gbWFwcGluZyhhZGRyZXNzID0+IHVpbnQyNTYpKSBwdWJsaWMgX2FsbG93
ZWQ7CgogICAgZXZlbnQgVHJhbnNmZXIoYWRkcmVzcyBpbmRleGVkIGZyb20sIGFkZHJlc3MgaW5k
ZXhlZCB0bywgdWludDI1NiB2YWx1ZSk7CiAgICBldmVudCBBcHByb3ZhbCgKICAgICAgICBhZGRy
ZXNzIGluZGV4ZWQgb3duZXIsCiAgICAgICAgYWRkcmVzcyBpbmRleGVkIHNwZW5kZXIsCiAgICAg
ICAgdWludDI1NiB2YWx1ZQogICAgKTsKCiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgICBfYmFs
YW5jZXNbbXNnLnNlbmRlcl0gPSBfdG90YWxTdXBwbHk7CiAgICAgICAgZW1pdCBUcmFuc2Zlcihh
ZGRyZXNzKDApLCBtc2cuc2VuZGVyLCBfdG90YWxTdXBwbHkpOwogICAgfQoKICAgIGZ1bmN0aW9u
IHRvdGFsU3VwcGx5KCkgcHVibGljIHZpZXcgcmV0dXJucyAodWludCkgewogICAgICAgIHJldHVy
biBfdG90YWxTdXBwbHkgLSBfYmFsYW5jZXNbYWRkcmVzcygwKV07CiAgICB9CgogICAgZnVuY3Rp
b24gYmFsYW5jZU9mKGFkZHJlc3MgX293bmVyKSBwdWJsaWMgdmlldyByZXR1cm5zICh1aW50IGJh
bGFuY2UpIHsKICAgICAgICByZXR1cm4gX2JhbGFuY2VzW19vd25lcl07CiAgICB9CgogICAgZnVu
Y3Rpb24gYWxsb3dhbmNlKGFkZHJlc3MgX293bmVyLCBhZGRyZXNzIF9zcGVuZGVyKSBwdWJsaWMg
dmlldyByZXR1cm5zICh1aW50IHJlbWFpbmluZykgewogICAgICAgIHJldHVybiBfYWxsb3dlZFtf
b3duZXJdW19zcGVuZGVyXTsKICAgIH0KCiAgICBmdW5jdGlvbiB0cmFuc2ZlcihhZGRyZXNzIHRv
LCB1aW50MjU2IHZhbHVlKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAg
cmVxdWlyZShfYmFsYW5jZXNbbXNnLnNlbmRlcl0gPj0gdmFsdWUsICJTYWxkbyBpbnN1ZmljaWVu
dGUiKTsKICAgICAgICBfYmFsYW5jZXNbbXNnLnNlbmRlcl0gLT0gdmFsdWU7CiAgICAgICAgX2Jh
bGFuY2VzW3RvXSArPSB2YWx1ZTsKICAgICAgICBlbWl0IFRyYW5zZmVyKG1zZy5zZW5kZXIsIHRv
LCB2YWx1ZSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gYXBwcm92
ZSgKICAgICAgICBhZGRyZXNzIHNwZW5kZXIsCiAgICAgICAgdWludDI1NiB2YWx1ZQogICAgKSBw
dWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7CiAgICAgICAgX2FsbG93ZWRbbXNnLnNlbmRl
cl1bc3BlbmRlcl0gPSB2YWx1ZTsKICAgICAgICBlbWl0IEFwcHJvdmFsKG1zZy5zZW5kZXIsIHNw
ZW5kZXIsIHZhbHVlKTsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICBmdW5jdGlvbiB0
cmFuc2ZlckZyb20oCiAgICAgICAgYWRkcmVzcyBmcm9tLAogICAgICAgIGFkZHJlc3MgdG8sCiAg
ICAgICAgdWludDI1NiB2YWx1ZQogICAgKSBwdWJsaWMgcmV0dXJucyAoYm9vbCBzdWNjZXNzKSB7
CiAgICAgICAgcmVxdWlyZShfYmFsYW5jZXNbZnJvbV0gPj0gdmFsdWUsICJTYWxkbyBpbnN1Zmlj
aWVudGUiKTsKICAgICAgICByZXF1aXJlKAogICAgICAgICAgICBfYWxsb3dlZFtmcm9tXVttc2cu
c2VuZGVyXSA+PSB2YWx1ZSwKICAgICAgICAgICAgIlNlbSBwZXJtaXNzYW8gc3VmaWNpZW50ZSIK
ICAgICAgICApOwoKICAgICAgICBfYmFsYW5jZXNbZnJvbV0gLT0gdmFsdWU7CiAgICAgICAgX2Jh
bGFuY2VzW3RvXSArPSB2YWx1ZTsKICAgICAgICBfYWxsb3dlZFtmcm9tXVttc2cuc2VuZGVyXSAt
PSB2YWx1ZTsKCiAgICAgICAgZW1pdCBUcmFuc2Zlcihmcm9tLCB0bywgdmFsdWUpOwogICAgICAg
IHJldHVybiB0cnVlOwogICAgfQp9Cg==